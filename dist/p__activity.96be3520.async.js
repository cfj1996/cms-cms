(self.webpackChunkcms_cms=self.webpackChunkcms_cms||[]).push([[932],{78844:function(H,I,e){"use strict";var f=e(22122),A=e(28991),v=e(81253),m=e(67294),j=e(44018),E=e(51617),x=e(66758),P=["fieldProps","proFieldProps"],s="dateTimeRange",n=m.forwardRef(function(O,B){var M=O.fieldProps,$=O.proFieldProps,C=(0,v.Z)(O,P),F=(0,m.useContext)(x.Z);return m.createElement(j.Z,(0,f.Z)({ref:B,mode:"edit",fieldProps:(0,A.Z)({getPopupContainer:F.getPopupContainer},M),valueType:s,proFieldProps:$,filedConfig:{valueType:s,lightFilterLabelFormatter:function(Y){return(0,E.Z)(Y,"YYYY-MM-DD HH:mm:ss")}}},C))});I.Z=n},53158:function(H,I,e){"use strict";e.r(I),e.d(I,{default:function(){return te}});var f=e(93224),A=e(34792),v=e(48086),m=e(3182),j=e(71194),E=e(50146),x=e(57663),P=e(71577),s=e(94043),n=e.n(s),O=e(67265),B=e(27571),M=e(93279),$=e(49101),C=e(67294),F=e(15435),b=e(11849),Y=e(9715),K=e(41003),X=e(2824),R=e(5966),z=e(78844),V=e(64317),G=e(47319),J=e(29410),N=e(30381),L=e.n(N),i=e(85893),Q={labelCol:{xs:{span:6}},wrapperCol:{xs:{span:16}}},k=(0,C.forwardRef)(function(h,D){var W=K.Z.useForm(),U=(0,X.Z)(W,1),S=U[0],y=h.data?{title:h.data.title,content:h.data.content,number:h.data.number,list_title:h.data.list_title,associate:h.data.associate,images:h.data.images,time:[L()(h.data.start_time),L()(h.data.end_time)]}:void 0;return(0,C.useImperativeHandle)(D,function(){return{submit:function(){S.submit()}}}),(0,i.jsxs)(K.Z,(0,b.Z)((0,b.Z)({form:S,initialValues:y},Q),{},{children:[(0,i.jsx)(R.Z,{name:"title",label:"\u6D3B\u52A8\u6807\u9898",required:!0,rules:[{required:!0}]}),(0,i.jsx)(R.Z,{name:"content",label:"\u6D3B\u52A8\u5185\u5BB9",required:!0,rules:[{required:!0}]}),(0,i.jsx)(R.Z,{name:"number",label:"\u6D3B\u52A8\u7F16\u53F7",required:!0,rules:[{required:!0}]}),(0,i.jsx)(z.Z,{label:"\u8D77\u81F3\u65F6\u95F4",name:"time",required:!0,rules:[{required:!0}],fieldProps:{disabledDate:function(t){return!t||t.isBefore(L()().startOf("day"))}}}),(0,i.jsx)(R.Z,{name:"list_title",label:"\u699C\u5355\u6807\u9898",required:!0,rules:[{required:!0}]}),(0,i.jsx)(V.Z,{mode:"multiple",request:function(){return(0,J.CY)({current:1,pageSize:1e4,state:"onsale"}).then(function(t){return t.data.map(function(d){return{value:d.id,label:d.name}})})},name:"associate",label:"\u5173\u8054nft\u4F5C\u54C1",required:!0,rules:[{required:!0}]}),(0,i.jsx)(K.Z.Item,{name:"images",label:"\u6D3B\u52A8\u56FE\u7247",required:!0,rules:[{required:!0}],children:(0,i.jsx)(G.Z,{multiple:!0})})]}))}),w=k,q=k,T=e(18021),_=e(97633),ee=function(){var D=(0,C.useRef)(),W=[{title:"\u6807\u9898",dataIndex:"title",key:"keywords"},{title:"\u7F16\u53F7",dataIndex:"number",hideInSearch:!0},{dataIndex:"state",title:"\u72B6\u6001",key:"state",valueType:"select",valueEnum:T.XX},{dataIndex:"images",title:"\u56FE\u7247",hideInSearch:!0,render:function(Z,t){return(0,i.jsx)(_.Z,{alt:t.title,src:t.images[0],images:t.images.map(function(d){return{src:d,alt:t.title}})})}},{dataIndex:"start_time",title:"\u6D3B\u52A8\u5F00\u59CB\u65F6\u95F4",valueType:"dateTime",hideInSearch:!0},{dataIndex:"end_time",title:"\u6D3B\u52A8\u7ED3\u675F\u65F6\u95F4",valueType:"dateTime",hideInSearch:!0},{dataIndex:"created_at",title:"\u521B\u5EFA\u65F6\u95F4",valueType:"dateTime",hideInSearch:!0},{dataIndex:"updated_at",title:"\u4FEE\u6539\u65F6\u95F4",valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",align:"right",valueType:"option",render:function(Z,t){return[(0,i.jsx)(P.Z,{style:{padding:0},type:"link",disabled:t.state==="onsale",onClick:function(){S(t)},children:"\u7F16\u8F91"},0),(0,i.jsx)(M.Z,{onSelect:function(c){c==="1"?E.Z.confirm({title:"\u786E\u5B9A\u4E0A\u67B6\u5417?",onOk:function(){return(0,m.Z)(n().mark(function l(){var r;return n().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,T.$k)(t.id,"onsale").catch(function(a){throw v.default.error("\u64CD\u4F5C\u5931\u8D25,\u7A0D\u540E\u91CD\u8BD5\u3002"),a});case 2:(r=D.current)===null||r===void 0||r.reload();case 3:case"end":return u.stop()}},l)}))()}}):c==="2"?E.Z.confirm({title:"\u786E\u5B9A\u4E0B\u67B6\u5417?",onOk:function(){return(0,m.Z)(n().mark(function l(){var r;return n().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,T.$k)(t.id,"offsale").catch(function(a){throw v.default.error("\u64CD\u4F5C\u5931\u8D25,\u7A0D\u540E\u91CD\u8BD5\u3002"),a});case 2:(r=D.current)===null||r===void 0||r.reload();case 3:case"end":return u.stop()}},l)}))()}}):E.Z.confirm({title:"\u786E\u5B9A\u5220\u9664\u5417?",onOk:function(){return(0,m.Z)(n().mark(function l(){var r;return n().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,T.lE)(t.id).catch(function(a){throw v.default.error("\u64CD\u4F5C\u5931\u8D25,\u7A0D\u540E\u91CD\u8BD5\u3002"),a});case 2:(r=D.current)===null||r===void 0||r.reload();case 3:case"end":return u.stop()}},l)}))()}})},menus:[{key:"1",name:"\u4E0A\u67B6",disabled:t.state==="onsale"},{key:"2",name:"\u4E0B\u67B6",disabled:t.state!=="onsale"},{key:"3",name:"\u5220\u9664"}]},1)]}}];function U(){F.Z.open({title:"\u65B0\u589E\u6D3B\u52A8",content:(0,i.jsx)(q,{}),onOK:function(Z,t){return(0,m.Z)(n().mark(function d(){var c,g,l,r,p;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=t==null?void 0:t.values,g=c.time,l=(0,f.Z)(c,["time"]),l.start_time=g[0].toDate(),l.end_time=g[0].toDate(),console.log("other",l),a.prev=4,a.next=7,(0,T.xn)(l);case 7:if(r=a.sent,r.code!=="ok"){a.next=13;break}v.default.success("\u6DFB\u52A0\u6210\u529F"),(p=D.current)===null||p===void 0||p.reload(),a.next=14;break;case 13:throw new Error(r.msg);case 14:a.next=20;break;case 16:return a.prev=16,a.t0=a.catch(4),v.default.error(a.t0.message),a.abrupt("return",Promise.reject());case 20:case"end":return a.stop()}},d,null,[[4,16]])}))()}})}function S(y){F.Z.open({title:"\u7F16\u8F91\u6D3B\u52A8",content:(0,i.jsx)(w,{data:y}),onOK:function(t,d){return(0,m.Z)(n().mark(function c(){var g,l,r,p,u;return n().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return g=d==null?void 0:d.values,l=g.time,r=(0,f.Z)(g,["time"]),r.activity_id=y.id,r.start_time=l[0].toDate(),r.end_time=l[0].toDate(),console.log("other",r),o.prev=5,o.next=8,(0,T.zx)(r);case 8:if(p=o.sent,p.code!=="ok"){o.next=14;break}v.default.success("\u7F16\u8F91\u6210\u529F"),(u=D.current)===null||u===void 0||u.reload(),o.next=15;break;case 14:throw new Error(p.msg);case 15:o.next=21;break;case 17:return o.prev=17,o.t0=o.catch(5),v.default.error(o.t0.message),o.abrupt("return",Promise.reject());case 21:case"end":return o.stop()}},c,null,[[5,17]])}))()}})}return(0,i.jsx)(O.ZP,{children:(0,i.jsx)(B.ZP,{actionRef:D,columns:W,request:(0,m.Z)(n().mark(function y(){var Z,t=arguments;return n().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return Z=t.length>0&&t[0]!==void 0?t[0]:{},c.abrupt("return",(0,T.H2)(Z));case 2:case"end":return c.stop()}},y)})),columnsState:{persistenceKey:"pro-table-singe-demos-3",persistenceType:"localStorage"},rowKey:"id",search:{labelWidth:"auto"},dateFormatter:"number",headerTitle:"\u6D3B\u52A8\u7BA1\u7406",toolBarRender:function(){return[(0,i.jsx)(P.Z,{icon:(0,i.jsx)($.Z,{}),type:"primary",onClick:function(){return U()},children:"\u65B0\u5EFA"},"button")]}})})},te=ee},18021:function(H,I,e){"use strict";e.d(I,{XX:function(){return A},xn:function(){return v},H2:function(){return m},lE:function(){return j},zx:function(){return E},$k:function(){return x}});var f=e(67607),A={draf:{text:"\u8349\u7A3F",status:"Default"},onsale:{text:"\u4E0A\u67B6",status:"Success"},offsale:{text:"\u4E0B\u67B6",status:"Error"}},v=function(s){return f.Z.post("/activity/create",s)},m=function(s){return f.Z.get("/activity/search",s).then(function(n){return{success:n.code==="ok",data:n.data.list,total:n.data.total}})},j=function(s){return f.Z.post("/activity/delete",{activity_id:s})},E=function(s){return f.Z.post("/activity/edit",s)},x=function(s,n){return f.Z.post("/activity/state/update",{activity_id:s,state:n})}}}]);
